#!/bin/sh
# Goblin Pre-commit Hook - Quality Gate
# Prevents bad code from being committed by running quality checks

echo "üîç Running quality checks..."

# TypeScript check - fail on any errors
if ! bun run typecheck 2>&1; then
  echo "‚ùå TypeScript errors found!"
  echo "Run: bun run typecheck to fix"
  exit 1
fi

# Biome check - fail on any errors (warnings don't block commit)
if ! bun run lint 2>&1 | grep -E "(Found [0-9]+ errors)"; then
  echo "‚ùå Lint errors found!"
  echo "Run: bun run lint:fix to fix"
  exit 1
fi

# Optional: Auto-fix common issues
# Uncomment to enable auto-fix for simple issues
# bun run lint:fix --only-files="$(git diff --cached --name-only --diff-filter=AM | head -5)"

echo "‚úÖ Quality checks passed!"